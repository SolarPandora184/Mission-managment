<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mission Management</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 1rem; background: #f5f5f5; }
    section { margin-bottom: 2rem; }
    h2 { border-bottom: 1px solid #ccc; }
    input, button, textarea {
      margin-top: 0.5rem;
      display: block;
      padding: 0.5rem;
      font-size: 1rem;
    }
    #chatMessages, #commsLog, #fileList {
      border: 1px solid #ccc;
      height: 150px;
      overflow-y: auto;
      padding: 0.5rem;
    }
    #loginSection, #createAccountSection {
      max-width: 400px;
      margin: 2rem auto;
      background: white;
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

<!-- LOGIN SECTION -->
<div id="loginSection">
  <h2>Mission Access</h2>
  <input type="text" id="usernameInput" placeholder="Username" />
  <input type="password" id="passwordInput" placeholder="Password" />
  <button id="loginBtn">Login</button>
  <button id="createAccountBtn">Create Account</button>
  <p id="loginError" style="color:red;"></p>
</div>

<!-- CREATE ACCOUNT SECTION -->
<div id="createAccountSection" style="display:none;">
  <h2>Request an Account</h2>
  <p>
    To request an account, please email <strong>Kendrick Uhles</strong> and CC <strong>Laramie Uhles</strong>.<br />
    Include your desired <strong>username</strong> and <strong>password</strong>.
  </p>
  <p>Email Kendrick: 
    <a href="mailto:kendrick.uhles@cawgcap.org?cc=laramie.uhles@cawgcap.org&subject=Mission%20System%20Account%20Request">
      kendrick.uhles@cawgcap.org
    </a>
  </p>
  <button id="backToLoginBtn">&larr; Back to Login</button>
</div>

<!-- MAIN APP SECTION -->
<div id="mainApp" style="display:none;">
  <h1>Mission Management</h1>

  <section id="missions">
    <h2>Missions</h2>
    <div id="missionList"></div>
    <input type="text" id="newMissionName" placeholder="New mission name" />
    <button id="createMissionBtn">Create Mission</button>
  </section>

  <section id="chat">
    <h2>Chat</h2>
    <p>Mission: <span id="currentMissionName">None</span></p>
    <div id="chatMessages"></div>
    <input type="text" id="chatInput" placeholder="Type a message" />
    <button id="sendChatBtn">Send</button>
  </section>

  <section id="comms">
    <h2>Comms Log</h2>
    <p>Mission: <span id="currentMissionName2">None</span></p>
    <div id="commsLog"></div>
    <input type="text" id="commsInput" placeholder="Log entry" />
    <button id="logCommsBtn">Log</button>
  </section>

  <section id="files">
    <h2>Files</h2>
    <p>Mission: <span id="currentMissionName3">None</span></p>
    <input type="file" id="fileUpload" />
    <button id="uploadFileBtn">Upload</button>
    <ul id="fileList"></ul>
  </section>
</div>

<script>
  // Simple in-code login users
  const USERS = {
    "CommanderK": "SecurePass123",
    "LaramieU": "RadioOps456",
    "TestUser": "TestPass789"
  };

  // Login button event
  document.getElementById('loginBtn').onclick = () => {
    const user = document.getElementById('usernameInput').value.trim();
    const pass = document.getElementById('passwordInput').value;

    if (USERS[user] === pass) {
      document.getElementById('loginSection').style.display = 'none';
      document.getElementById('mainApp').style.display = 'block';
      document.getElementById('loginError').textContent = '';
    } else {
      document.getElementById('loginError').textContent = "Incorrect username or password.";
    }
  };

  // Show create account info
  document.getElementById('createAccountBtn').onclick = () => {
    document.getElementById('loginSection').style.display = 'none';
    document.getElementById('createAccountSection').style.display = 'block';
  };

  // Back to login from create account
  document.getElementById('backToLoginBtn').onclick = () => {
    document.getElementById('createAccountSection').style.display = 'none';
    document.getElementById('loginSection').style.display = 'block';
    document.getElementById('loginError').textContent = '';
  };

  // Mission data and state
  const missions = [];
  let currentMission = null;

  const missionListEl = document.getElementById('missionList');
  const currentMissionNameEls = [
    document.getElementById('currentMissionName'),
    document.getElementById('currentMissionName2'),
    document.getElementById('currentMissionName3')
  ];
  const chatMessagesEl = document.getElementById('chatMessages');
  const commsLogEl = document.getElementById('commsLog');
  const fileListEl = document.getElementById('fileList');

  // Update mission name display on all sections
  function updateMissionDisplays() {
    const name = currentMission ? currentMission.name : 'None';
    currentMissionNameEls.forEach(el => el.textContent = name);
  }

  // Refresh mission list with buttons
  function refreshMissionList() {
    missionListEl.innerHTML = '';
    missions.forEach((m, i) => {
      const btn = document.createElement('button');
      btn.textContent = m.name;
      btn.onclick = () => {
        currentMission = m;
        updateMissionDisplays();
        renderChat();
        renderComms();
        renderFiles();
      };
      missionListEl.appendChild(btn);
    });
  }

  // Render chat messages
  function renderChat() {
    if (!currentMission) {
      chatMessagesEl.textContent = 'Select a mission';
      return;
    }
    chatMessagesEl.innerHTML = '';
    currentMission.chat.forEach(msg => {
      const div = document.createElement('div');
      div.textContent = msg;
      chatMessagesEl.appendChild(div);
    });
  }

  // Render comms log entries
  function renderComms() {
    if (!currentMission) {
      commsLogEl.textContent = 'Select a mission';
      return;
    }
    commsLogEl.innerHTML = '';
    currentMission.comms.forEach(log => {
      const div = document.createElement('div');
      div.textContent = log;
      commsLogEl.appendChild(div);
    });
  }

  // Render uploaded files list
  function renderFiles() {
    if (!currentMission) {
      fileListEl.innerHTML = '<li>Select a mission</li>';
      return;
    }
    fileListEl.innerHTML = '';
    currentMission.files.forEach(f => {
      const li = document.createElement('li');
      li.textContent = f.name;
      fileListEl.appendChild(li);
    });
  }

  // Create mission button event
  document.getElementById('createMissionBtn').onclick = () => {
    const input = document.getElementById('newMissionName');
    const name = input.value.trim();
    if (!name) {
      alert('Please enter a mission name');
      return;
    }
    const newMission = { name, chat: [], comms: [], files: [] };
    missions.push(newMission);
    currentMission = newMission;
    updateMissionDisplays();
    refreshMissionList();
    input.value = '';
    renderChat();
    renderComms();
    renderFiles();
  };

  // Send chat message event
  document.getElementById('sendChatBtn').onclick = () => {
    const input = document.getElementById('chatInput');
    if (!currentMission) return alert('Select a mission first');
    const msg = input.value.trim();
    if (!msg) return;
    currentMission.chat.push(msg);
    input.value = '';
    renderChat();
  };

  // Log comms event
  document.getElementById('logCommsBtn').onclick = () => {
    const input = document.getElementById('commsInput');
    if (!currentMission) return alert('Select a mission first');
    const log = input.value.trim();
    if (!log) return;
    currentMission.comms.push(log);
    input.value = '';
    renderComms();
  };

  // Upload file event
  document.getElementById('uploadFileBtn').onclick = () => {
    if (!currentMission) return alert('Select a mission first');
    const fileInput = document.getElementById('fileUpload');
    if (!fileInput.files.length) return alert('Select a file to upload');
    currentMission.files.push({ name: fileInput.files[0].name });
    fileInput.value = '';
    renderFiles();
  };

  // Initialize
  refreshMissionList();
  updateMissionDisplays();
</script>
</body>
</html>
