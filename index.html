<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mission Management</title>
<style>
  body { font-family: Arial, sans-serif; margin: 1rem; }
  section { margin-bottom: 2rem; }
  h2 { border-bottom: 1px solid #ccc; }
  input, button, textarea { margin-top: 0.5rem; display: block; }
  #chatMessages, #commsLog, #fileList { border: 1px solid #ccc; height: 150px; overflow-y: auto; padding: 0.5rem; }
</style>
</head>
<body>

<h1>Mission Management (Rough)</h1>

<section id="missions">
  <h2>Missions</h2>
  <div id="missionList"></div>
  <input type="text" id="newMissionName" placeholder="New mission name" />
  <button id="createMissionBtn">Create Mission</button>
</section>

<section id="chat">
  <h2>Chat</h2>
  <p>Mission: <span id="currentMissionName">None</span></p>
  <div id="chatMessages"></div>
  <input type="text" id="chatInput" placeholder="Type a message" />
  <button id="sendChatBtn">Send</button>
</section>

<section id="comms">
  <h2>Comms Log</h2>
  <p>Mission: <span id="currentMissionName2">None</span></p>
  <div id="commsLog"></div>
  <input type="text" id="commsInput" placeholder="Log entry" />
  <button id="logCommsBtn">Log</button>
</section>

<section id="files">
  <h2>Files</h2>
  <p>Mission: <span id="currentMissionName3">None</span></p>
  <input type="file" id="fileUpload" />
  <button id="uploadFileBtn">Upload</button>
  <ul id="fileList"></ul>
</section>

<script>
  // Simple in-memory data store (no persistence)
  const missions = [];
  let currentMission = null;

  const missionListEl = document.getElementById('missionList');
  const currentMissionNameEls = [
    document.getElementById('currentMissionName'),
    document.getElementById('currentMissionName2'),
    document.getElementById('currentMissionName3')
  ];
  const chatMessagesEl = document.getElementById('chatMessages');
  const commsLogEl = document.getElementById('commsLog');
  const fileListEl = document.getElementById('fileList');

  function updateMissionDisplays() {
    const name = currentMission ? currentMission.name : 'None';
    currentMissionNameEls.forEach(el => el.textContent = name);
  }

  function refreshMissionList() {
    missionListEl.innerHTML = '';
    missions.forEach((m, i) => {
      const btn = document.createElement('button');
      btn.textContent = m.name;
      btn.onclick = () => {
        currentMission = m;
        updateMissionDisplays();
        renderChat();
        renderComms();
        renderFiles();
      };
      missionListEl.appendChild(btn);
    });
  }

  function renderChat() {
    if (!currentMission) {
      chatMessagesEl.textContent = 'Select a mission';
      return;
    }
    chatMessagesEl.innerHTML = '';
    currentMission.chat.forEach(msg => {
      const div = document.createElement('div');
      div.textContent = msg;
      chatMessagesEl.appendChild(div);
    });
  }

  function renderComms() {
    if (!currentMission) {
      commsLogEl.textContent = 'Select a mission';
      return;
    }
    commsLogEl.innerHTML = '';
    currentMission.comms.forEach(log => {
      const div = document.createElement('div');
      div.textContent = log;
      commsLogEl.appendChild(div);
    });
  }

  function renderFiles() {
    if (!currentMission) {
      fileListEl.innerHTML = '<li>Select a mission</li>';
      return;
    }
    fileListEl.innerHTML = '';
    currentMission.files.forEach(f => {
      const li = document.createElement('li');
      li.textContent = f.name;
      fileListEl.appendChild(li);
    });
  }

  document.getElementById('createMissionBtn').onclick = () => {
    const input = document.getElementById('newMissionName');
    const name = input.value.trim();
    if (!name) {
      alert('Please enter a mission name');
      return;
    }
    const newMission = { name, chat: [], comms: [], files: [] };
    missions.push(newMission);
    currentMission = newMission;
    updateMissionDisplays();
    refreshMissionList();
    input.value = '';
    renderChat();
    renderComms();
    renderFiles();
  };

  document.getElementById('sendChatBtn').onclick = () => {
    const input = document.getElementById('chatInput');
    if (!currentMission) return alert('Select a mission first');
    const msg = input.value.trim();
    if (!msg) return;
    currentMission.chat.push(msg);
    input.value = '';
    renderChat();
  };

  document.getElementById('logCommsBtn').onclick = () => {
    const input = document.getElementById('commsInput');
    if (!currentMission) return alert('Select a mission first');
    const log = input.value.trim();
    if (!log) return;
    currentMission.comms.push(log);
    input.value = '';
    renderComms();
  };

  document.getElementById('uploadFileBtn').onclick = () => {
    if (!currentMission) return alert('Select a mission first');
    const fileInput = document.getElementById('fileUpload');
    if (!fileInput.files.length) return alert('Select a file to upload');
    // Just store file name in memory
    currentMission.files.push({ name: fileInput.files[0].name });
    fileInput.value = '';
    renderFiles();
  };

  refreshMissionList();
  updateMissionDisplays();
</script>

</body>
</html>
