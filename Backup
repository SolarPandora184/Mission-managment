<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mission Management</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 1rem; }
    h2 { border-bottom: 1px solid #ccc; }
    section { margin-bottom: 2rem; }
    button { cursor: pointer; }

    #missionListContainer, #missionInfoContainer {
      display: none;
    }

    #missionListContainer.active,
    #missionInfoContainer.active {
      display: block;
    }

    #missionList {
      border: 1px solid #ccc;
      max-height: 300px;
      overflow-y: auto;
      padding: 0.5rem;
    }

    #missionList button {
      display: block;
      width: 100%;
      text-align: left;
      margin: 0.25rem 0;
      padding: 0.5rem;
      background: #f0f0f0;
      border: none;
      font-size: 1rem;
    }

    #missionList button:hover {
      background: #ddd;
    }

    #createMissionBtn {
      float: right;
      margin-bottom: 1rem;
    }

    #missionTabs button {
      padding: 0.5rem 1rem;
      margin-right: 0.5rem;
      border: none;
      background: #eee;
      font-weight: bold;
    }

    #missionTabs button.active {
      background: #007BFF;
      color: white;
    }

    .tabContent {
      display: none;
    }

    .tabContent.active {
      display: block;
    }

    #backBtn {
      margin-bottom: 1rem;
      background: #888;
      color: white;
      padding: 0.5rem 1rem;
      border: none;
    }
  </style>
</head>
<body>

<h1>Mission Management</h1>

<!-- Mission List Page -->
<div id="missionListContainer" class="active">
  <button id="createMissionBtn">Create Mission</button>
  <h2>Missions</h2>
  <input type="text" id="missionSearch" placeholder="Search missions..." />
  <div id="missionList"></div>
</div>

<!-- Mission Info Page -->
<div id="missionInfoContainer">
  <button id="backBtn">‚Üê Back to Missions</button>
  <h2 id="missionTitle"></h2>

  <div id="missionTabs">
    <button data-tab="chat" class="tabBtn active">Chat</button>
    <button data-tab="comms" class="tabBtn">Comms Log</button>
    <button data-tab="files" class="tabBtn">Files</button>
  </div>

  <div id="chat" class="tabContent active">
    <h3>Chat</h3>
    <div id="chatMessages" style="border:1px solid #ccc; height:150px; overflow-y:auto; padding:0.5rem;"></div>
    <input type="text" id="chatInput" placeholder="Type a message" />
    <button id="sendChatBtn">Send</button>
  </div>

  <div id="comms" class="tabContent">
    <h3>Comms Log</h3>
    <div id="commsLog" style="border:1px solid #ccc; height:150px; overflow-y:auto; padding:0.5rem;"></div>
    <input type="text" id="commsInput" placeholder="Log entry" />
    <button id="logCommsBtn">Log</button>
  </div>

  <div id="files" class="tabContent">
    <h3>Files</h3>
    <input type="file" id="fileUpload" />
    <button id="uploadFileBtn">Upload</button>
    <ul id="fileList"></ul>
  </div>
</div>

<script>
  const missions = [];
  let currentMission = null;

  const missionListContainer = document.getElementById('missionListContainer');
  const missionInfoContainer = document.getElementById('missionInfoContainer');
  const missionTitle = document.getElementById('missionTitle');
  const missionListEl = document.getElementById('missionList');
  const missionSearchEl = document.getElementById('missionSearch');

  const chatMessagesEl = document.getElementById('chatMessages');
  const commsLogEl = document.getElementById('commsLog');
  const fileListEl = document.getElementById('fileList');

  function showMissionList() {
    missionListContainer.classList.add('active');
    missionInfoContainer.classList.remove('active');
    currentMission = null;
  }

  function showMissionInfo() {
    missionListContainer.classList.remove('active');
    missionInfoContainer.classList.add('active');
    missionTitle.textContent = `${currentMission.name} (${currentMission.number})`;
    renderChat();
    renderComms();
    renderFiles();
  }

  function renderMissionList() {
    const filter = missionSearchEl.value.toLowerCase();
    missionListEl.innerHTML = '';
    missions
      .filter(m => `${m.name} ${m.number}`.toLowerCase().includes(filter))
      .forEach(m => {
        const btn = document.createElement('button');
        btn.textContent = `${m.name} (${m.number})`;
        btn.onclick = () => {
          currentMission = m;
          showMissionInfo();
        };
        missionListEl.appendChild(btn);
      });
  }

  // Chat
  function renderChat() {
    if (!currentMission) return;
    chatMessagesEl.innerHTML = '';
    currentMission.chat.forEach(msg => {
      const div = document.createElement('div');
      div.textContent = msg;
      chatMessagesEl.appendChild(div);
    });
  }

  document.getElementById('sendChatBtn').onclick = () => {
    const input = document.getElementById('chatInput');
    const msg = input.value.trim();
    if (!msg || !currentMission) return;
    currentMission.chat.push(msg);
    input.value = '';
    renderChat();
  };

  // Comms
  function renderComms() {
    if (!currentMission) return;
    commsLogEl.innerHTML = '';
    currentMission.comms.forEach(log => {
      const div = document.createElement('div');
      div.textContent = log;
      commsLogEl.appendChild(div);
    });
  }

  document.getElementById('logCommsBtn').onclick = () => {
    const input = document.getElementById('commsInput');
    const log = input.value.trim();
    if (!log || !currentMission) return;
    currentMission.comms.push(log);
    input.value = '';
    renderComms();
  };

  // Files
  function renderFiles() {
    if (!currentMission) return;
    fileListEl.innerHTML = '';
    currentMission.files.forEach(f => {
      const li = document.createElement('li');
      li.textContent = f.name;
      fileListEl.appendChild(li);
    });
  }

  document.getElementById('uploadFileBtn').onclick = () => {
    const fileInput = document.getElementById('fileUpload');
    if (!fileInput.files.length || !currentMission) return;
    currentMission.files.push({ name: fileInput.files[0].name });
    fileInput.value = '';
    renderFiles();
  };

  // Tab switching
  document.querySelectorAll('.tabBtn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.tabBtn').forEach(b => b.classList.remove('active'));
      document.querySelectorAll('.tabContent').forEach(tab => tab.classList.remove('active'));
      btn.classList.add('active');
      document.getElementById(btn.dataset.tab).classList.add('active');
    });
  });

  // Mission create
  document.getElementById('createMissionBtn').onclick = () => {
    const name = prompt('Mission Name:');
    if (!name) return;
    const number = prompt('Mission Number:');
    if (!number) return;
    const newMission = { name, number, chat: [], comms: [], files: [] };
    missions.push(newMission);
    renderMissionList();
  };

  // Search
  missionSearchEl.oninput = renderMissionList;

  // Back
  document.getElementById('backBtn').onclick = showMissionList;

  // Init
  showMissionList();
  renderMissionList();
</script>

</body>
</html>
